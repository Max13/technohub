{{--
##      ##    ###    ##    ## ########    ##     ## ########          ##    ## ########  #######
##  ##  ##   ## ##   ##   ##  ##          ##     ## ##     ##         ###   ## ##       ##     ##
##  ##  ##  ##   ##  ##  ##   ##          ##     ## ##     ##         ####  ## ##       ##     ##
##  ##  ## ##     ## #####    ######      ##     ## ########          ## ## ## ######   ##     ##
##  ##  ## ######### ##  ##   ##          ##     ## ##                ##  #### ##       ##     ##
##  ##  ## ##     ## ##   ##  ##          ##     ## ##         ##     ##   ### ##       ##     ## ###
 ###  ###  ##     ## ##    ## ########     #######  ##        ##      ##    ## ########  #######  ###
--}}

<!-- Wake Up, Neo. ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠉⠉⠉⠀⠀⠉⠙⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠛⠛⠉⠉⠉⠉⠙⠛⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠉⠀⠰⣏⣤⣤⣆⣠⣀⣀⣀⣀⡉⠛⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⠋⠀⢲⢢⢤⣀⡀⠀⠀⠀⠀⠀⠀⠈⢻⣿⣿⣿⣿⣿⡟⠀⠀⠀⠀⠘⣿⣾⡝⠻⢷⠿⠟⡿⠋⠀⠘⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⠟⠋⠀⠠⣔⣮⣭⠉⠙⠉⢁⡥⠞⠀⠀⠀⠀⠈⣿⣿⣿⣿⣿⡇⠂⠀⠀⠒⢄⠈⠉⠿⣧⡄⠲⠟⣿⣶⣤⡄⠈⠻⣿⣿⣿⣿
⣿⣿⣋⣥⣤⣲⣼⣽⣿⣿⠗⣦⣄⡴⠋⠔⠁⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⡤⠀⠀⠀⠀⠉⠈⢀⠹⠿⡟⠒⠛⢿⣿⣾⣤⠄⠙⢿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⠏⠉⠀⠀⠀⡰⠀⢩⠂⠀⣆⠀⠀⣸⣿⣿⣿⣿⣿⣷⡤⠀⠒⠢⡄⢄⠀⠡⣄⠑⣤⡄⠀⠙⢻⣿⣿⣿⣾⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣃⡀⠈⣷⡆⢠⣅⣶⠀⢤⣿⠁⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣷⡀⠀⠹⣀⠈⠻⣿⣽⡛⢿⣧⠀⠀⠻⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⣽⡟⢠⣿⡿⠀⠀⡼⠤⢄⣰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡄⠀⠙⣆⠁⠨⠿⣋⠀⠙⢦⠀⠀⢹⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⠠⡀⠀⣿⠃⠾⡿⠃⠀⢠⠃⠀⢨⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣆⢀⣹⡄⠀⠀⠹⡄⠀⠈⢆⠀⢨⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣧⣄⣤⠃⠀⢸⠁⠀⠀⣾⣀⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣤⣴⣧⣤⣤⣾⣷⣾⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣦⣼⣷⣦⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
-->

@extends('layouts.app')

@section('bodyClass', 'd-flex align-items-center')
@section('bsTheme', 'dark')

@push('styles')
    <style>
        main {
            max-width: 700px;
        }

        #form-matrix [type=submit] {
            --bs-btn-bg: transparent;
            --bs-btn-hover-bg: transparent;
            --bs-btn-hover-border-color: var(--matrix-green);
            --bs-btn-border-color: var(--matrix-green);
        }
        #form-matrix [type=submit]:hover {
            box-shadow: 0 0 20px 10px var(--matrix-green);
            /*box-shadow: 0 1rem 3rem rgba(0, 255, 64, .175);*/
            /*transform: scale(1.04);*/
        }
    </style>
@endpush

@section('content')
    <x-matrix-rain :message="$remoteAddr" />
    <main class="m-auto w-100">
        <img class="d-block mt-4 mb-5 w-50 mx-auto" src="{{ mix('/img/logo-h_white.svg') }}" alt="ITIC Logo">
        <p class="text-center text-muted matrix-font fs-4">Follow the white rabbit.</p>

        <div class="col-md-4 offset-md-4">
            @if (session()->has('success'))
                <div class="alert alert-success mt-4 p-2" role="alert">
                    {{ session('success') }}
                </div>
            @endif

            @if ($errors->any())
                <div class="alert alert-danger mt-4 p-2" role="alert">
                    @if ($errors->count() === 1)
                        <span class="visually-hidden">{{ __('Error') }}: </span>{{ $errors->first() }}
                    @else
                        <ul>
                            @foreach($errors->all() as $message)
                                <li class="text-start"><span class="visually-hidden">{{ __('Error') }}: </span>{{ $message }}</li>
                            @endforeach
                        </ul>
                    @endif
                </div>
            @endif

            <form id="form-matrix" class="row g-3" action="{{ route('auth.itic.doLogin') }}" method="post">
                @csrf

                <div class="col-12">
                    <label class="visually-hidden" for="username">{{ __('Username') }}</label>
                    <input type="text" class="form-control" id="username" name="username" value="{{ old('username') }}" placeholder="{{ __('Username') }}">
                </div>

                <div class="col-12">
                    <label class="visually-hidden" for="password">{{ __('Username') }}</label>
                    <input type="password" class="form-control" id="password" name="password" placeholder="{{ __('Password') }}">
                </div>

                <div class="col-12">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="remember" name="remember" value="1">
                        <label class="form-check-label" for="remember">{{ __('Remember me') }}</label>
                    </div>
                </div>

                <div class="col-12">
                    <button type="submit" class="btn w-100">{{ __('Login') }}</button>
                    <button type="button" class="btn w-100 d-none" disabled>
                        <span role="status">{{ __('Loading') }}</span>
                        <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                    </button>
                    <button type="button" class="btn btn-sm btn-link w-100 mt-1" data-bs-toggle="modal" data-bs-target="#password-reset-modal">{{ __('Reset my password') }}</button>
                </div>
            </form>

        </div>

        <p class="mt-4 text-center text-muted small">{{ __('If you need help, contact the IT!') }}</p>
    </main>

    <div class="modal fade" id="password-reset-modal" tabindex="-1" aria-labelledby="password-reset-label" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="password-reset-label">{{ __('Reset my password') }}</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="{{ __('Close') }}"></button>
                </div>
                <div class="modal-body">
                    <form id="password-reset-form" action="{{ route('auth.itic.sendPasswordReset') }}" method="post">
                        @csrf
                        <label for="email" class="form-label mb-4">{{ __('Enter your NetYparéo email address, if it matches an account, you will receive a password reset link') }}</label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="{{ __('Email') }}" value="{{ old('email') }}">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="submit" form="password-reset-form" class="btn btn-primary">{{ __('Confirm') }}</button>
                </div>
            </div>
        </div>
    </div>
@endsection

@push('scripts')
    <script src="{{ mix('/js/app.js') }}"></script>
    <script>
        document.getElementById('form-matrix').addEventListener('submit', ev => {
            const submitBtn = ev.submitter;
            const loadingBtn = submitBtn.nextElementSibling;

            submitBtn.classList.add('d-none');
            loadingBtn.classList.remove('d-none');
        });
    </script>
@endpush
